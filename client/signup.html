<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>K-Chat | Sign up</title>
  <link rel="icon" href="/src/chat.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Rubik&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/signup.css" />
</head>

<body>
  <div class="signup-page">
    <div class="signup-image">
      <h1>
        <span>C</span>
        <span>h</span>
        <span>a</span>
        <span>t</span>
        <span> </span>
        <span>w</span>
        <span>i</span>
        <span>t</span>
        <span>h</span>
        <span> </span>
        <span>K</span>
        <span>-</span>
        <span>C</span>
        <span>h</span>
        <span>a</span>
        <span>t</span>
        <span>!</span>
      </h1>
    </div>
    <div class="signup-form">
      <form action="/user/signup" method="post">
        <section class="form-title">
          <h2>Sign Up</h2>
          <p>Already have an account? <a href="/">Log In</a></p>
        </section>
        <div>
          <label for="firstName">First Name: </label>
          <input type="text" name="firstName" required>
        </div>
        <div>
          <label for="lastName">Last Name: </label>
          <input type="text" name="lastName" required>
        </div>
        <div>
          <label for="nickName">Nickname: </label>
          <input type="text" name="nickName" required>
        </div>
        <div>
          <label for="password">Password: </label>
          <input type="password" name="password" required>
          <i class="eye-slash"></i>
        </div>
        <div>
          <label for="email">Email: </label>
          <input type="text" name="email" required/>
          <p style="color: red; font-size: 0;" class="email-tag">Email had been used</p>
        </div>
        <div>
          <button type="submit">Sign up</button>
        </div>
      </form>
    </div>
    <footer></footer>
  </div>

  <script type="text/javascript">
    const eyeSlash = document.querySelector('.eye-slash')
    eyeSlash.addEventListener('click', (e) => {
      const input = document.querySelector('form input[name="password"]') 
      if (input.type === 'text'){
        input.type = 'password'
      }else if (input.type === 'password'){
        input.type = 'text'
      }
    })

    document.querySelector('form').addEventListener('submit', (event) => {
      event.preventDefault();
      fetch(event.target.action, {
          method: 'POST',
          body: new URLSearchParams(new FormData(event.target))
      }).then((res) => {
          if(res.status == '406'){
            const emailTag = document.querySelector('.email-tag')
            emailTag.style.fontSize = '12px'
          }
          if(res.status == '200'){
            console.log('signed up')
            window.location.href = "/"
          }
      }).catch((error) => {
          console.log(2)
      });
    });

  </script>

</body>
</html>