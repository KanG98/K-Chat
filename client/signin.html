<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Rubik&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/signup.css" />
  <title>K-Chat | Sign In</title>
  <link rel="icon" href="/src/chat.png">
</head>

<body>
  <div class="signup-page">
    <div class="signup-image">
      <h1>
        <span>C</span>
        <span>h</span>
        <span>a</span>
        <span>t</span>
        <span> </span>
        <span>w</span>
        <span>i</span>
        <span>t</span>
        <span>h</span>
        <span> </span>
        <span>K</span>
        <span>-</span>
        <span>C</span>
        <span>h</span>
        <span>a</span>
        <span>t</span>
        <span>!</span>
      </h1>    </div>
    <div class="signup-form">
    <form class="login-form" action="http://localhost:3030/user/login" method="post">
      <section class="form-title">
        <h2>Sign In</h2>
        <p>Don't have an account? <a href="http://localhost:3030/signup.html">Sign up</a></p>
      </section>
      <div>
        <label>Email</label>
        <input type="text" name="email" id="email">
      </div>
      <div>
        <label>Password</label>
        <input type="password" name="password" id="password">
        <p style="color: red; font-size: 0;" class="login-tag">User not exist or wrong password</p>
        <i class="eye-slash"></i>
      </div>

      <button type="submit" class="login-button">Log In</button>
      <div class="contactme-section">
        <p>Something went wrong?  Contact me:</p>
        <div class="contactme-email" onclick="window.location = 'mailto:yankang198@gmail.com'"></div>
        <div class="contactme-linkedin" onclick="window.open('https://www.linkedin.com/in/yankang-kyle-xue', '_blank');"></div>
      </div>

    </form>
    
    <!-- <script src="./js/redirect.js"></script> -->
    <script type="text/javascript">

      const eyeSlash = document.querySelector('.eye-slash')
      eyeSlash.addEventListener('click', (e) => {
        const input = document.querySelector('form input[name="password"]') 
        if (input.type === 'text'){
          input.type = 'password'
        }else if (input.type === 'password'){
          input.type = 'text'
        }
      })
    </script>
        
    </div>
    <footer>
    </footer>
  </div>

  <script type="text/javascript">
    document.querySelector('form').addEventListener('submit', (event) => {
      event.preventDefault();
      fetch(event.target.action, {
          method: 'POST',
          body: new URLSearchParams(new FormData(event.target))
      }).then((res) => {
          if(res.status == '406'){
            const emailTag = document.querySelector('.login-tag')
            emailTag.style.fontSize = '12px'
          }
          if(res.status == '200'){
            window.location.href = "http://localhost:3030"
          }
      }).catch((error) => {
          console.log(2)
      });
    });

  </script>
</body>
</html>